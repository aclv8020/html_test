<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LangFlow with Astra DB</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    #output {
      margin-top: 20px;
      padding: 10px;
      border: 1px solid #ccc;
      background-color: #f9f9f9;
    }
  </style>
</head>
<body>
  <h1>LangFlow with Astra DB111</h1>
  <label for="inputValue">Enter your input:</label>
  <input type="text" id="inputValue" placeholder="Type something...">
  <button id="fetchData">Submit</button>
  <div id="output"></div>

  <script>
    document.getElementById('fetchData').addEventListener('click', () => {
      const inputValue = document.getElementById('inputValue').value; // Get input from the user

      fetch(
        "https://astra.datastax.com/api/v1/run/0cfa4355-1399-458f-9592-42a560fcdd18?stream=false",
        {
          method: "POST",
          headers: {
            "Authorization": "Bearer AstraCS:eZTrvkmgCkDOvCIlRBIXkvQu:e9585829f2900e7f1cfff7b06e7ac133f3413c8572c0408495a1001fce73a945", // Replace <TOKEN> with your actual token
            "Content-Type": "application/json"
              
            <!-- "x-api-key": "<your-api-key>" // Replace <your-api-key> with your actual API key -->
          },
          body: JSON.stringify({
            input_value: inputValue, // Use the user's input
            output_type: "chat",
            input_type: "chat",
            tweaks: {
              "ChatInput-S9nei": {
                "background_color": "",
                "chat_icon": "",
                "files": "",
                "input_value": inputValue, // Use the user's input here
                "sender": "User",
                "sender_name": "User",
                "session_id": "",
                "should_store_message": true,
                "text_color": ""
              },
              "ParseData-fdmaQ": {
                "sep": "\n",
                "template": "{text}"
              },
              "Prompt-nQ3t8": {
                "context": "",
                "question": "",
                "template": "{context}\n\n---\n\nGiven the context above, answer the question as best as possible.\n\nQuestion: {question}\n\nAnswer: ",
                "tool_placeholder": ""
              },
              "SplitText-pN3Ty": {
                "chunk_overlap": 200,
                "chunk_size": 1000,
                "separator": "Openai API",
                "text_key": "text"
              },
              "ChatOutput-6LWzc": {
                "background_color": "",
                "chat_icon": "",
                "clean_data": true,
                "data_template": "{text}",
                "input_value": "",
                "sender": "Machine",
                "sender_name": "AI",
                "session_id": "",
                "should_store_message": true,
                "text_color": ""
              },
              "File-BJTNW": {
                "concurrency_multithreading": 4,
                "delete_server_file_after_processing": true,
                "ignore_unspecified_files": false,
                "ignore_unsupported_extensions": true,
                "path": "",
                "silent_errors": false,
                "use_multithreading": false
              },
              "OpenAIModel-6rhWE": {
                "api_key": "LF on Astra OpenAI API",
                "input_value": "",
                "json_mode": false,
                "max_retries": 5,
                "max_tokens": null,
                "model_kwargs": {},
                "model_name": "gpt-4o-mini",
                "openai_api_base": "",
                "seed": 1,
                "stream": false,
                "system_message": "You are a cheeky 85 year old British professor. Use crass humor and British references and royal analogies whenever possible.",
                "temperature": 0.1,
                "timeout": 700
              },
              "AstraDB-FEq2F": {
                "advanced_search_filter": "{}",
                "api_endpoint": "https://c9f1c8a4-8184-4753-88c9-581821159eb2-us-east-2.apps.astra.datastax.com",
                "astradb_vectorstore_kwargs": "{}",
                "autodetect_collection": true,
                "collection_name": "easyicpcollection",
                "content_field": "",
                "database_name": "easyicp",
                "deletion_field": "",
                "embedding_choice": "Astra Vectorize",
                "environment": "",
                "ignore_invalid_documents": false,
                "keyspace": "",
                "number_of_results": 4,
                "search_query": "",
                "search_score_threshold": 0,
                "search_type": "Similarity",
                "should_cache_vector_store": true,
                "token": "ASTRA_DB_APPLICATION_TOKEN"
              },
              "AstraDB-RDMeo": {
                "advanced_search_filter": "{}",
                "api_endpoint": "https://c9f1c8a4-8184-4753-88c9-581821159eb2-us-east-2.apps.astra.datastax.com",
                "astradb_vectorstore_kwargs": "{}",
                "autodetect_collection": true,
                "collection_name": "easyicpcollection",
                "content_field": "",
                "database_name": "easyicp",
                "deletion_field": "",
                "embedding_choice": "Astra Vectorize",
                "environment": "",
                "ignore_invalid_documents": false,
                "keyspace": "",
                "number_of_results": 4,
                "search_query": "",
                "search_score_threshold": 0,
                "search_type": "Similarity",
                "should_cache_vector_store": true,
                "token": "ASTRA_DB_APPLICATION_TOKEN"
              }
            }
          }),
        }
      )
        .then(res => res.json())
        .then(data => {
          // Display the response in the output div
          document.getElementById('output').innerText = JSON.stringify(data, null, 2);
        })
        .catch(error => {
          console.error('Error:', error);
          document.getElementById('output').innerText = 'Error: ' + error.message;
        });
    });
  </script>
</body>
</html>
